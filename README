Work in progress. Code still needs to be polished up a bit.
